import{c as J,n as F,m as L,h as K,t as O,s as W,d as Z,D as f,b as E,aS as $,G as ee,a as g,I as G,Q as X,p as te,f as oe,w as le,o as ae,k as se}from"./index-69ba64b0.js";import{u as ne}from"./index-9d342087.js";import{a as ie}from"./index-45798041.js";const[ue,b]=J("rate");function re(e,o,s,n){return e>=o?{status:"full",value:1}:e+.5>=o&&s&&!n?{status:"half",value:.5}:e+1>=o&&s&&n?{status:"half",value:Math.round((e-o+1)*1e10)/1e10}:{status:"void",value:0}}const ce={size:F,icon:L("star"),color:String,count:K(5),gutter:F,clearable:Boolean,readonly:Boolean,disabled:Boolean,voidIcon:L("star-o"),allowHalf:Boolean,voidColor:String,touchable:O,iconPrefix:String,modelValue:W(0),disabledColor:String};var de=Z({name:ue,props:ce,emits:["change","update:modelValue"],setup(e,{emit:o}){const s=ie(),[n,u]=ne(),r=f(),c=E(()=>e.readonly||e.disabled),S=E(()=>c.value||!e.touchable),x=E(()=>Array(+e.count).fill("").map((l,t)=>re(e.modelValue,t+1,e.allowHalf,e.readonly)));let i,m,T=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER;const P=()=>{m=X(r);const l=n.value.map(X);i=[],l.forEach((t,a)=>{T=Math.min(t.top,T),p=Math.max(t.top,p),e.allowHalf?i.push({score:a+.5,left:t.left,top:t.top,height:t.height},{score:a+1,left:t.left+t.width/2,top:t.top,height:t.height}):i.push({score:a+1,left:t.left,top:t.top,height:t.height})})},I=(l,t)=>{for(let a=i.length-1;a>0;a--)if(t>=m.top&&t<=m.bottom){if(l>i[a].left&&t>=i[a].top&&t<=i[a].top+i[a].height)return i[a].score}else{const h=t<m.top?T:p;if(l>i[a].left&&i[a].top===h)return i[a].score}return e.allowHalf?.5:1},V=l=>{c.value||l===e.modelValue||(o("update:modelValue",l),o("change",l))},U=l=>{S.value||(s.start(l),P())},Y=l=>{if(!S.value&&(s.move(l),s.isHorizontal()&&!s.isTap.value)){const{clientX:t,clientY:a}=l.touches[0];te(l),V(I(t,a))}},Q=(l,t)=>{const{icon:a,size:h,color:y,count:N,gutter:k,voidIcon:C,disabled:d,voidColor:M,allowHalf:z,iconPrefix:B,disabledColor:_}=e,w=t+1,H=l.status==="full",v=l.status==="void",j=z&&l.value>0&&l.value<1;let D;k&&w!==+N&&(D={paddingRight:oe(k)});const q=A=>{P();let R=z?I(A.clientX,A.clientY):w;e.clearable&&s.isTap.value&&R===e.modelValue&&(R=0),V(R)};return g("div",{key:t,ref:u(t),role:"radio",style:D,class:b("item"),tabindex:d?void 0:0,"aria-setsize":N,"aria-posinset":w,"aria-checked":!v,onClick:q},[g(G,{size:h,name:H?a:C,class:b("icon",{disabled:d,full:H}),color:d?_:H?y:M,classPrefix:B},null),j&&g(G,{size:h,style:{width:l.value+"em"},name:v?C:a,class:b("icon",["half",{disabled:d,full:!v}]),color:d?_:v?M:y,classPrefix:B},null)])};return $(()=>e.modelValue),ee("touchmove",Y,{target:r}),()=>g("div",{ref:r,role:"radiogroup",class:b({readonly:e.readonly,disabled:e.disabled}),tabindex:e.disabled?void 0:0,"aria-disabled":e.disabled,"aria-readonly":e.readonly,onTouchstartPassive:U},[x.value.map(Q)])}});const ge=le(de);function fe(e,o){let s=null,n=new Date;return function(){let u=new Date;clearTimeout(s),u-n>=o?(e(),n=new Date):s=setTimeout(()=>{e()},o)}}function be(e){let o=window;const s=f(!1),n=f(0),u=f(0),r=f(0),c=fe(()=>{o===window?(n.value=document.documentElement.clientHeight,u.value=document.body.scrollTop||document.documentElement.scrollTop,r.value=document.body.scrollHeight||document.documentElement.scrollHeight):(n.value=o.clientHeight,u.value=o.scrollTop,r.value=o.scrollHeight),u.value+n.value+1>=r.value&&(console.log("滚动到底部啦~"),s.value=!0)},100);return ae(()=>{e&&(o=e.value),o.addEventListener("scroll",c)}),se(()=>{e&&(o=e.value),o==null||o.removeEventListener("scroll",c)}),{isReachBottom:s,clientHeight:n,scrollTop:u,scrollHeight:r}}export{ge as R,be as u};
