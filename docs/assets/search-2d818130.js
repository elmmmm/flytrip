import{N as de}from"./index-b18a7dd4.js";import{P as _e,S as pe}from"./search-bar-e815de6d.js";import{c as W,t as U,n as J,h as Z,m as ve,d as z,D as S,af as q,ae as me,b as Y,x as he,aD as fe,G as ge,a as m,Q as Ce,ar as ye,aE as be,z as Se,aj as Q,T as ke,i as we,v as L,F as Ie,al as $e,am as xe,l as X,I as Pe,w as G,e as Ve,r as De,u as He,ax as Oe,_ as V,j as ee,W as c,X as h,$ as f,a0 as H,a1 as w,a2 as $,ac as I,aF as te,aB as A,a9 as T,ab as P,a5 as Te,Y as Ae,Z as Ee,a3 as Re}from"./index-69ba64b0.js";import{C as Be,S as Fe}from"./index-9ae070ce.js";import{u as Ne}from"./use-id-1792710b.js";import{u as ae,h as se}from"./index-45798041.js";import{S as Ue}from"./search-list-item-52ca83fe.js";import"./index-0721e516.js";import"./city-7cc509fb.js";const[oe,R]=W("dropdown-menu"),We={overlay:U,zIndex:J,duration:Z(.2),direction:ve("down"),activeColor:String,closeOnClickOutside:U,closeOnClickOverlay:U},ne=Symbol(oe);var ze=z({name:oe,props:We,setup(t,{slots:a}){const s=Ne(),o=S(),e=S(),i=S(0),{children:_,linkChildren:l}=q(ne),u=me(o),d=Y(()=>_.some(n=>n.state.showWrapper)),p=Y(()=>{if(d.value&&he(t.zIndex))return{zIndex:+t.zIndex+1}}),v=()=>{_.forEach(n=>{n.toggle(!1)})},g=()=>{t.closeOnClickOutside&&v()},C=()=>{if(e.value){const n=Ce(e);t.direction==="down"?i.value=n.bottom:i.value=ye.value-n.top}},r=()=>{d.value&&C()},y=n=>{_.forEach((b,k)=>{k===n?b.toggle():b.state.showPopup&&b.toggle(!1,{immediate:!0})})},O=(n,b)=>{const{showPopup:k}=n.state,{disabled:x,titleClass:D}=n;return m("div",{id:`${s}-${b}`,role:"button",tabindex:x?void 0:0,class:[R("item",{disabled:x}),{[be]:!x}],onClick:()=>{x||y(b)}},[m("span",{class:[R("title",{down:k===(t.direction==="down"),active:k}),D],style:{color:k?t.activeColor:""}},[m("div",{class:"van-ellipsis"},[n.renderTitle()])])])};return ae({close:v}),l({id:s,props:t,offset:i,updateOffset:C}),fe(o,g),ge("scroll",r,{target:u,passive:!0}),()=>{var n;return m("div",{ref:o,class:R()},[m("div",{ref:e,style:p.value,class:R("bar",{opened:d.value})},[_.map(O)]),(n=a.default)==null?void 0:n.call(a)])}}});const[Ge,B]=W("dropdown-item"),Me={title:String,options:we(),disabled:Boolean,teleport:[String,Object],lazyRender:U,modelValue:L,titleClass:L};var Ye=z({name:Ge,inheritAttrs:!1,props:Me,emits:["open","opened","close","closed","change","update:modelValue"],setup(t,{emit:a,slots:s,attrs:o}){const e=Se({showPopup:!1,transition:!0,showWrapper:!1}),{parent:i,index:_}=Q(ne);if(!i)return;const l=n=>()=>a(n),u=l("open"),d=l("close"),p=l("opened"),v=()=>{e.showWrapper=!1,a("closed")},g=n=>{t.teleport&&n.stopPropagation()},C=(n=!e.showPopup,b={})=>{n!==e.showPopup&&(e.showPopup=n,e.transition=!b.immediate,n&&(i.updateOffset(),e.showWrapper=!0))},r=()=>{if(s.title)return s.title();if(t.title)return t.title;const n=t.options.find(b=>b.value===t.modelValue);return n?n.text:""},y=n=>{const{activeColor:b}=i.props,k=n.value===t.modelValue,x=()=>{e.showPopup=!1,n.value!==t.modelValue&&(a("update:modelValue",n.value),a("change",n.value))},D=()=>{if(k)return m(Pe,{class:B("icon"),color:b,name:"success"},null)};return m(Be,{role:"menuitem",key:n.value,icon:n.icon,title:n.text,class:B("option",{active:k}),style:{color:k?b:""},tabindex:k?0:-1,clickable:!0,onClick:x},{value:D})},O=()=>{const{offset:n}=i,{zIndex:b,overlay:k,duration:x,direction:D,closeOnClickOverlay:ue}=i.props,M=Ie(b);return D==="down"?M.top=`${n.value}px`:M.bottom=`${n.value}px`,$e(m("div",X({style:M,class:B([D]),onClick:g},o),[m(_e,{show:e.showPopup,"onUpdate:show":E=>e.showPopup=E,role:"menu",class:B("content"),overlay:k,position:D==="down"?"top":"bottom",duration:e.transition?x:0,lazyRender:t.lazyRender,overlayStyle:{position:"absolute"},"aria-labelledby":`${i.id}-${_.value}`,closeOnClickOverlay:ue,onOpen:u,onClose:d,onOpened:p,onClosed:v},{default:()=>{var E;return[t.options.map(y),(E=s.default)==null?void 0:E.call(s)]}})]),[[xe,e.showWrapper]])};return ae({state:e,toggle:C,renderTitle:r}),()=>t.teleport?m(ke,{to:t.teleport},{default:()=>[O()]}):O()}});const le=G(Ye),ce=G(ze),[re,je]=W("sidebar"),ie=Symbol(re),Le={modelValue:Z(0)};var Ke=z({name:re,props:Le,emits:["change","update:modelValue"],setup(t,{emit:a,slots:s}){const{linkChildren:o}=q(ie),e=()=>+t.modelValue;return o({getActive:e,setActive:_=>{_!==e()&&(a("update:modelValue",_),a("change",_))}}),()=>{var _;return m("div",{role:"tablist",class:je()},[(_=s.default)==null?void 0:_.call(s)])}}});const Je=G(Ke),[Ze,K]=W("sidebar-item"),qe=Ve({},De,{dot:Boolean,title:String,badge:J,disabled:Boolean,badgeProps:Object});var Qe=z({name:Ze,props:qe,emits:["click"],setup(t,{emit:a,slots:s}){const o=He(),{parent:e,index:i}=Q(ie);if(!e)return;const _=()=>{t.disabled||(a("click",i.value),e.setActive(i.value),o())};return()=>{const{dot:l,badge:u,title:d,disabled:p}=t,v=i.value===e.getActive();return m("div",{role:"tab",class:K({select:v,disabled:p}),tabindex:p?void 0:0,"aria-selected":v,onClick:_},[m(Oe,X({dot:l,class:K("text"),content:u},t.badgeProps),{default:()=>[s.title?s.title():d]})])}}});const Xe=G(Qe);const et={key:0,class:"side-bar"},tt={class:"side-menu"},at={class:"content"},st=["onClick"],ot={class:"name"},nt={key:0,class:"desp"},lt={key:1,class:"sub-side-panel"},ct={class:"sub-side-bar"},rt={class:"sub-content"},it=["onClick"],ut={class:"name"},dt={key:0,class:"desp"},_t={__name:"index",props:{menuData:{type:Array,default:()=>[]}},emits:["itemClick"],setup(t,{emit:a}){const s=t,o=S(0),e=S([]);ee(()=>s.menuData,(p,v)=>{e.value=p},{immediate:!0});const i=p=>console.log(`侧边导航标签 ${o.value}`),_=(p,v)=>{e.value[p]&&((e.value[p].items||[]).forEach((C,r)=>{C.isSelect=r===v}),a("itemClick",{sideDatas:e.value,currentSideActive:p,index:v}))},l=S(0),u=Y(()=>e.value[o.value].subGroups||[]),d=p=>{e.value[o.value]&&(((e.value[o.value].subGroups||[])[l.value].items||[]).forEach((C,r)=>{C.isSelect=r===p}),a("itemClick",{sideDatas:e.value,currentSideActive:o.value,currentSubSideActive:l.value,indez:p}))};return(p,v)=>{const g=Xe,C=Je;return e.value.length?(c(),h("div",et,[f("div",tt,[m(C,{modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=r=>o.value=r),onChange:i},{default:H(()=>[(c(!0),h(w,null,$(e.value,(r,y)=>(c(),I(g,{key:y,title:r.label},null,8,["title"]))),128))]),_:1},8,["modelValue"])]),f("div",at,[te(p.$slots,"content",{},()=>[e.value[o.value].items.length?(c(!0),h(w,{key:0},$(e.value[o.value].items,(r,y)=>(c(),h("div",{key:y,class:A(["list-item",r.isSelect?"active":""]),onClick:O=>_(o.value,y)},[f("div",ot,T(r.label),1),r.percentageUser?(c(),h("span",nt,T(r.percentageUser),1)):P("",!0)],10,st))),128)):P("",!0),u.value.length?(c(),h("div",lt,[f("div",ct,[m(C,{modelValue:l.value,"onUpdate:modelValue":v[1]||(v[1]=r=>l.value=r)},{default:H(()=>[(c(!0),h(w,null,$(u.value,(r,y)=>(c(),I(g,{key:y,title:r.label},null,8,["title"]))),128))]),_:1},8,["modelValue"])]),f("div",rt,[(c(!0),h(w,null,$(u.value[l.value].items,(r,y)=>(c(),h("div",{key:y,class:A(["list-item",r.isSelect?"active":""]),onClick:O=>d(y)},[f("div",ut,T(r.label),1),r.percentageUser?(c(),h("span",dt,T(r.percentageUser),1)):P("",!0)],10,it))),128))])])):P("",!0)],!0)])])):P("",!0)}}},pt=V(_t,[["__scopeId","data-v-a311a0fd"]]);const vt={class:"view-house-btns"},mt={__name:"index",emits:["clear","viewClick"],setup(t,{emit:a}){const s=()=>{a("clear")},o=()=>{a("viewClick")};return(e,i)=>(c(),h("div",vt,[f("div",{class:"clear",onClick:s},"清空"),f("div",{class:"view-house",onClick:o},"查看房屋(220套)")]))}},ht=V(mt,[["__scopeId","data-v-43bd915c"]]);const ft={class:"dropdown-bar-panel-content"},gt={__name:"dropdown-select",props:{itemsData:{type:Array,default:()=>[]}},setup(t){const a=u=>{console.log("当前选择--",u)},s=S(0),o=[{text:"欢迎度排序",value:0},{text:"好评优先",value:1},{text:"点评数多->少",value:2},{text:"低价优先",value:3},{text:"高价优先",value:4}],e={},i=u=>{u&&(e[u.title]=u)},_=u=>{var d;(d=e[u])==null||d.toggle()},l=u=>{var d;(d=e[u])==null||d.toggle()};return(u,d)=>{const p=le,v=ce;return c(),I(v,null,{default:H(()=>[(c(!0),h(w,null,$(t.itemsData,(g,C)=>(c(),h(w,null,[g.gType===2?(c(),I(p,{key:0,title:"位置",ref_for:!0,ref:i},{default:H(()=>[f("div",ft,[m(pt,{class:"top",menuData:g.subGroups,onItemClick:a},null,8,["menuData"]),m(ht,{class:"bottom",onClear:d[0]||(d[0]=r=>_("位置")),onViewClick:d[1]||(d[1]=r=>l("位置"))})])]),_:2},1024)):P("",!0),g.gType===4?(c(),I(p,{key:1,modelValue:s.value,"onUpdate:modelValue":d[2]||(d[2]=r=>s.value=r),options:o},null,8,["modelValue"])):P("",!0)],64))),256))]),_:1})}}},Ct=V(gt,[["__scopeId","data-v-b25c9718"]]);const yt={__name:"tag-select-item",props:{title:{type:String,default:"标签名"},type:{type:String,default:"default"},active:{type:Boolean,default:!1}},emits:["tagClick"],setup(t,{emit:a}){const s=t,o=()=>{a("tagClick",s.title)};return(e,i)=>(c(),h("div",{class:A(["tag-select-item",t.type,t.active?"active":""]),onClick:o},T(t.title),3))}},j=V(yt,[["__scopeId","data-v-4e9ab7fc"]]);const bt={class:"tag-select"},St={class:"drow-content"},kt={__name:"tag-select",props:{itemsData:{type:Array,default:()=>{}}},setup(t){const a=t,s={},o=l=>{l&&(s[l.title]=l)},e=S([]);ee(()=>a.itemsData,l=>{e.value=l});const i=l=>{e.value.forEach((u,d)=>{u.isSelect=d===l})},_=(l,u,d)=>{var p;e.value.forEach((v,g)=>{g===l&&v.subFilterItems.forEach((r,y)=>{r.isSelect=y===u})}),(p=s[d])==null||p.toggle()};return(l,u)=>{const d=le,p=ce;return c(),h("div",bt,[(c(!0),h(w,null,$(e.value,(v,g)=>(c(),h(w,{key:g},[v.subFilterItems&&v.subFilterItems.length?(c(),I(p,{key:0},{default:H(()=>[m(d,{title:v.label,ref_for:!0,ref:o},{default:H(()=>[f("div",St,[(c(!0),h(w,null,$(v.subFilterItems,(C,r)=>(c(),I(j,{class:"d-item",type:"pink",title:C.label,active:C.isSelect,onTagClick:y=>_(g,r,v.label)},null,8,["title","active","onTagClick"]))),256))])]),_:2},1032,["title"])]),_:2},1024)):(c(),I(j,{key:1,title:v.label,active:v.isSelect,onTagClick:C=>i(g)},null,8,["title","active","onTagClick"]))],64))),128))])}}},wt=V(kt,[["__scopeId","data-v-b932ed5d"]]);class It{setCache(a,s){window.localStorage.setItem(a,JSON.stringify(s))}getCache(a){const s=window.localStorage.getItem(a);if(s)return JSON.parse(s)}deleteCache(a){window.localStorage.removeItem(a)}clearCache(){window.localStorage.clear()}}const F=new It,N="CACHE_SEARCH_HISTORY",$t=Te("search",{state:()=>({searchHistorys:[]}),getters:{getSearchHistorys:t=>{let a=t.searchHistorys||[];return a.length||(a=F.getCache(N)||[]),a=a.reverse(),a.map(s=>({itemType:"搜索历史",name:s}))}},actions:{initSearchHistory(){this.searchHistorys=F.getCache(N)||[]},addSearchHistory(t){this.searchHistorys.includes(t)||this.searchHistorys.push(t);let a=this.searchHistorys.length;a>=10&&(this.searchHistorys=this.searchHistorys.slice(a-10,a)),F.setCache(N,this.searchHistorys)},clearSearchHistory(){this.searchHistorys=[],F.deleteCache(N)}}});const xt=t=>(Ae("data-v-610b84a3"),t=t(),Ee(),t),Pt={class:"search-category"},Vt={class:"title"},Dt={class:"name"},Ht=xt(()=>f("span",{class:"m-name"},"展开",-1)),Ot={__name:"search-category",props:{title:{type:String,default:"热门搜索"},itemData:{type:Array,default:()=>[]}},emits:["tagClick"],setup(t,{emit:a}){const s=S(!1),o=()=>{s.value=!s.value},e=i=>{a("tagClick",i)};return(i,_)=>(c(),h("div",Pt,[f("div",Vt,[f("span",Dt,T(t.title),1),f("div",{class:"more",onClick:o},[te(i.$slots,"more",{},()=>[Ht,f("i",{class:A(["icon-more",s.value?"down":"up"])},null,2)],!0)])]),f("div",{class:A(["content",s.value?"hidden":""])},[(c(!0),h(w,null,$(t.itemData,l=>(c(),I(j,{title:l.name,type:"pink",onTagClick:u=>e(l)},null,8,["title","onTagClick"]))),256))],2)]))}},Tt=V(Ot,[["__scopeId","data-v-610b84a3"]]);const At={class:"search-panel"},Et={class:"search-category-panel"},Rt={__name:"search-panel",props:{searchPanelDatas:{type:Array,default:()=>{}}},emits:["cancel","search"],setup(t,{emit:a}){const s=$t();s.initSearchHistory();const o=S(""),e=l=>{s.addSearchHistory(l)},i=()=>{a("cancel")},_=l=>{console.log("tagClick",l)};return(l,u)=>{const d=Fe;return c(),h("div",At,[m(d,{modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=p=>o.value=p),"show-action":"",shape:"round",placeholder:"搜索景点、地标、房源",onSearch:e,onCancel:i},null,8,["modelValue"]),f("div",Et,[m(Tt,{title:"搜索历史","item-data":Re(s).getSearchHistorys,onTagClick:_},null,8,["item-data"])])])}}},Bt=V(Rt,[["__scopeId","data-v-d3fe7880"]]);function Ft(){return se.get({url:"/search/top"})}function Nt(){return se.get({url:"/search/result"})}const Ut={class:"search"},Wt={class:"search-nav-bar"},zt={class:"tab-wrapper"},Gt={class:"list"},Mt={__name:"search",setup(t){const a=S([]),s=S([]),o=S(!1);Ft().then(_=>{a.value=_.data.data.allConditions}),Nt().then(_=>{s.value=_.data.data});const e=()=>{o.value=!0},i=()=>{o.value=!1};return(_,l)=>(c(),h("div",Ut,[f("div",Wt,[m(de,null,{title:H(()=>[m(pe,{keyWord:"搜索景点、地标、房源",searchIcon:!1,onClick:e})]),_:1}),m(Ct,{itemsData:a.value},null,8,["itemsData"]),f("div",zt,[m(wt,{"items-data":s.value.hotFilters},null,8,["items-data"])])]),f("div",Gt,[(c(!0),h(w,null,$(s.value.items,(u,d)=>(c(),I(Ue,{"item-data":u},null,8,["item-data"]))),256))]),o.value?(c(),I(Bt,{key:0,onCancel:i})):P("",!0)]))}},ea=V(Mt,[["__scopeId","data-v-11740d9d"]]);export{ea as default};
