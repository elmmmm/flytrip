import{c as K,d as U,D as S,ae as rt,af as lt,b as D,x as ut,G,o as dt,j as H,a as m,T as ht,t as ft,n as Y,s as pt,ag as vt,M as P,Q as E,K as _t,ah as mt,ai as Q,p as gt,z as xt,aj as yt,e as kt,F as Ct,ak as bt,w as W,_ as Z,a6 as q,W as v,X as C,a0 as J,$ as L,a1 as I,a2 as R,a9 as Tt,ac as V,a7 as St,a3 as X,al as wt,am as At}from"./index-69ba64b0.js";/* empty css              */import"./index-9d342087.js";import{C as It,S as $t}from"./index-9ae070ce.js";import{u as tt}from"./city-7cc509fb.js";import{a as Rt,u as et}from"./index-45798041.js";import{T as Dt,a as Ot}from"./index-56f7fdd5.js";import"./use-id-1792710b.js";function Bt(){const t="A".charCodeAt(0);return Array(26).fill("").map((o,u)=>String.fromCharCode(t+u))}const[ot,B]=K("index-bar"),Pt={sticky:ft,zIndex:Y,teleport:[String,Object],highlightColor:String,stickyOffsetTop:pt(0),indexList:{type:Array,default:Bt}},nt=Symbol(ot);var Et=U({name:ot,props:Pt,emits:["select","change"],setup(t,{emit:g,slots:o}){const u=S(),r=S(),d=S(""),c=Rt(),h=rt(u),{children:n,linkChildren:x}=lt(nt);let a;x({props:t});const y=D(()=>{if(ut(t.zIndex))return{zIndex:+t.zIndex+1}}),f=D(()=>{if(t.highlightColor)return{color:t.highlightColor}}),_=(e,s)=>{for(let i=n.length-1;i>=0;i--){const p=i>0?s[i-1].height:0,l=t.sticky?p+t.stickyOffsetTop:0;if(e+l>=s[i].top)return i}return-1},w=e=>n.find(s=>String(s.index)===e),O=()=>{if(vt(u))return;const{sticky:e,indexList:s}=t,i=P(h.value),p=E(h),l=n.map(A=>A.getRect(h.value,p));let b=-1;if(a){const A=w(a);if(A){const T=A.getRect(h.value,p);b=_(T.top,l)}}else b=_(i,l);d.value=s[b],e&&n.forEach((A,T)=>{const{state:k,$el:it}=A;if(T===b||T===b-1){const $=it.getBoundingClientRect();k.left=$.left,k.width=$.width}else k.left=null,k.width=null;if(T===b)k.active=!0,k.top=Math.max(t.stickyOffsetTop,l[T].top-i)+p.top;else if(T===b-1&&a===""){const $=l[b].top-i;k.active=$>0,k.top=$+p.top-l[T].height}else k.active=!1}),a=""},N=()=>{_t(O)};G("scroll",O,{target:h,passive:!0}),dt(N),H(()=>t.indexList,N),H(d,e=>{e&&g("change",e)});const st=()=>t.indexList.map(e=>{const s=e===d.value;return m("span",{class:B("index",{active:s}),style:s?f.value:void 0,"data-index":e},[e])}),z=e=>{a=String(e);const s=w(a);if(s){const i=P(h.value),p=E(h),{offsetHeight:l}=document.documentElement;if(s.$el.scrollIntoView(),i===l-p.height){O();return}t.sticky&&t.stickyOffsetTop&&mt(Q()-t.stickyOffsetTop),g("select",s.index)}},M=e=>{const{index:s}=e.dataset;s&&z(s)},ct=e=>{M(e.target)};let j;const at=e=>{if(c.move(e),c.isVertical()){gt(e);const{clientX:s,clientY:i}=e.touches[0],p=document.elementFromPoint(s,i);if(p){const{index:l}=p.dataset;l&&j!==l&&(j=l,M(p))}}},F=()=>m("div",{ref:r,class:B("sidebar"),style:y.value,onClick:ct,onTouchstartPassive:c.start},[st()]);return et({scrollTo:z}),G("touchmove",at,{target:r}),()=>{var e;return m("div",{ref:u,class:B()},[t.teleport?m(ht,{to:t.teleport},{default:()=>[F()]}):F(),(e=o.default)==null?void 0:e.call(o)])}}});const[Lt,Vt]=K("index-anchor"),Nt={index:Y};var zt=U({name:Lt,props:Nt,setup(t,{slots:g}){const o=xt({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),u=S(),{parent:r}=yt(nt);if(!r)return;const d=()=>o.active&&r.props.sticky,c=D(()=>{const{zIndex:n,highlightColor:x}=r.props;if(d())return kt(Ct(n),{left:o.left?`${o.left}px`:void 0,width:o.width?`${o.width}px`:void 0,transform:o.top?`translate3d(0, ${o.top}px, 0)`:void 0,color:x})});return et({state:o,getRect:(n,x)=>{const a=E(u);return o.rect.height=a.height,n===window||n===document.body?o.rect.top=a.top+Q():o.rect.top=a.top+P(n)-x.top,o.rect}}),()=>{const n=d();return m("div",{ref:u,style:{height:n?`${o.rect.height}px`:void 0}},[m("div",{style:c.value,class:[Vt({sticky:n}),{[bt]:n}]},[g.default?g.default():t.index])])}}});const Mt=W(zt),jt=W(Et);const Ft={class:"city-group"},Gt={class:"list"},Ht=["onClick"],Xt={__name:"city-group",props:{groupData:{type:Object,default:()=>({})}},setup(t){const g=t,o=D(()=>{const c=g.groupData.cities.map(h=>h.group);return c.unshift("#"),c}),u=q(),r=tt(),d=c=>{r.currentCity=c,u.back()};return(c,h)=>{const n=Mt,x=It,a=jt;return v(),C("div",Ft,[m(a,{sticky:!0,"index-list":o.value,"highlight-color":"#ff9854"},{default:J(()=>[m(n,{index:"热门"}),L("div",Gt,[(v(!0),C(I,null,R(t.groupData.hotCities,(y,f)=>(v(),C("div",{class:"city",onClick:_=>d(y)},Tt(y.cityName),9,Ht))),256))]),(v(!0),C(I,null,R(t.groupData.cities,(y,f)=>(v(),C(I,{key:f},[m(n,{index:y.group},null,8,["index"]),(v(!0),C(I,null,R(y.cities,(_,w)=>(v(),V(x,{key:w,title:_.cityName,onClick:O=>d(_)},null,8,["title","onClick"]))),128))],64))),128))]),_:1},8,["index-list"])])}}},Kt=Z(Xt,[["__scopeId","data-v-f97eb3d1"]]);const Ut={class:"city top-page"},Yt={class:"top"},Qt={class:"content"},Wt={__name:"city",setup(t){const g=q(),o=S(""),u=()=>{g.back()},r=S(0);S({});const d=tt();d.fetchAllCitiesData();const{allCities:c}=St(d);return D(()=>c.value[r.value]),(h,n)=>{const x=$t,a=Ot,y=Dt;return v(),C("div",Ut,[L("div",Yt,[m(x,{modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=f=>o.value=f),placeholder:"城市/区域/位置",shape:"round","show-action":"",onCancel:u},null,8,["modelValue"]),m(y,{active:r.value,"onUpdate:active":n[1]||(n[1]=f=>r.value=f),color:"#ff9854"},{default:J(()=>[(v(!0),C(I,null,R(X(c),(f,_,w)=>(v(),V(a,{key:_,title:f.title,name:_},null,8,["title","name"]))),128))]),_:1},8,["active"])]),L("div",Qt,[(v(!0),C(I,null,R(X(c),(f,_,w)=>wt((v(),V(Kt,{"group-data":f},null,8,["group-data"])),[[At,r.value===_]])),256))])])}}},ce=Z(Wt,[["__scopeId","data-v-42f752b8"]]);export{ce as default};
